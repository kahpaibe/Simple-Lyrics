<!DOCTYPE html>
<link rel="stylesheet" type="text/css" href="styles.css" />
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Regular Expression Lyrics Display</title>
    <link rel="stylesheet" type="text/css" href="styles.css" />
    <script>
      function applyRegex() {
        var inputJapanese = document.getElementById("textInput").value;
        var inputText2 = document.getElementById("textInput2").value;
        var inputTitle = document.getElementById("titleInput").value;
        var title2 = document.getElementById("subtitleInput").value;

        inputJapanese = inputJapanese.replace(/(\r\n|\r|\n)/g, " <br> "); // Replace new lines with <br> tags
        inputJapanese += " <br>"; // Append text at the end of the inputText
        inputTitle = inputTitle.replace(/(\r\n|\r|\n)/g, " <br> "); // Replace new lines with <br> tags
        inputTitle += " "; // Append text at the end of the inputText

        var regexPattern = /(\S+?)\[(.+?)\](.*?)[\s\n\r$]/g; // Regex pattern for the specified substitution
        var rubyresult = inputJapanese.replace(
          regexPattern,
          "<ruby><rb>$1</rb><rt>$2</rt></ruby>$3"
        ); // Replace matches with the specified format
        var titleruby = inputTitle.replace(
          regexPattern,
          "<ruby><rb>$1</rb><rt>$2</rt></ruby>$3"
        ); // Replace matches with the specified format

        var lines = inputText2.split(/\r?\n/); // Split text from second input box into lines
        var rubyresultLines = rubyresult.split("<br>"); // Split result into lines

        var alignedResult = ""; // String to store aligned result

        // Loop through each line from the second input box and its corresponding line from the result
        for (var i = 0; i < lines.length; i++) {
          alignedResult +=
            '<div class="line"><div class="japanese-text">' +
            rubyresultLines[i] +
            '</div><div class="english-text">' +
            lines[i] +
            "</div></div>";
        }

        document.getElementById("alignedDisplay").innerHTML = alignedResult; // Display aligned result

        // Display raw substitution result
        document.getElementById("rawResult").textContent = rubyresult;

        // Set titles
        document.getElementById("Title").innerHTML = titleruby;
        document.getElementById("subTitle").textContent = title2;
      }
    </script>
  </head>
  <body>
    <div class="container">
      <div class="title-container">
        <label for="titleInput">Title</label><br />
        <input type="text" id="titleInput" />
      </div>
      <div class="title-container">
        <label for="subtitleInput">Subtitle</label><br />
        <input type="text" id="subtitleInput" />
      </div>
    </div>
    <div class="container">
      <div class="japanese-container">
        <label for="textInput">Japanese</label><br />
        <textarea id="textInput" rows="12" cols="50"></textarea>
      </div>
      <div class="english-container">
        <label for="textInput2">Translation</label><br />
        <textarea id="textInput2" rows="12" cols="50"></textarea>
      </div>
    </div>
    <button onclick="applyRegex()">Apply Regex</button><br />

    <h1><div id="Title"></div></h1>
    <h2><div id="subTitle"></div></h2>
    <label for="alignedDisplay">Aligned Result:</label><br />
    <div id="alignedDisplay"></div>
    <label for="rawResult">Raw Substitution Result:</label><br />
    <div id="rawResult"></div>
  </body>
</html>
